---
- name: Include OS-Specific variables.
  include_vars: "{{ item }}"
  with_first_found:
    - "{{ ansible_distribution }}-{{ ansible_distribution_major_version }}.yml"
    - "{{ ansible_os_family }}.yml"

- name: Ensure pecl is installed (if configured).
  package:
    name: "{{ php_pecl_package }}"
    state: present
  when: php_pecl_install_pecl

- name: Updating PECL channels.
  command: pecl update-channels
  register: php_pecl_updatechannels
  changed_when: "'succeeded' in php_pecl_updatechannels"

- include_tasks: install-pecl-extension.yml
  loop: "{{ php_pecl_extensions }}"
  loop_control:
    loop_var: php_pecl_extension
